<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <!-- ========================================================== -->
Â  Â  <!-- INI PERBAIKANNYA. Baris ini wajib ada di paling atas head. -->
Â  Â  <meta charset="UTF-8">
Â  Â  <!-- ========================================================== -->
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Kuis Kelas X Semester 1</title>
Â  Â  <!-- ========================================================== -->
Â  Â  <!-- BARU: Menambahkan Favicon (Ikon Tab) untuk fix error 404 -->
Â  Â  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“š</text></svg>">
Â  Â  <!-- ========================================================== -->
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <!-- Menambahkan font Montserrat (Bold 700) -->
Â  Â  <!-- PERUBAHAN FONT: Inter -> Poppins -->
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
Â  Â Â 
Â  Â  <!-- PERUBAHAN: Script MATHJAX (Kembali) -->
Â  Â  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
Â  Â  <!-- Konfigurasi MathJax agar mengenali \(...\) -->
Â  Â  <script>
Â  Â  Â  Â  MathJax = {
Â  Â  Â  Â  Â  tex: {
Â  Â  Â  Â  Â  Â  inlineMath: [['\\(', '\\)']]
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  </script>
Â  Â Â 
Â  Â  <style>
Â  Â  Â  Â  /* Menggunakan font Inter sebagai default */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  /* PERUBAHAN FONT: Inter -> Poppins */
Â  Â  Â  Â  Â  Â  font-family: 'Poppins', sans-serif;
Â  Â  Â  Â  Â  Â  overflow-x: hidden;
Â  Â  Â  Â  Â  Â  transition: background-color 300ms; /* Transisi untuk Dark Mode */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Canvas untuk latar belakang dinamis */
Â  Â  Â  Â  #bg-canvas {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100vw;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  z-index: -1;
Â  Â  Â  Â  Â  Â  /* Warna latar default (Terang) */
Â  Â  Â  Â  Â  Â  background-color: #89CFF0;Â 
Â  Â  Â  Â  Â  Â  transition: background-color 300ms;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Kontainer utama untuk di tengah layar */
Â  Â  Â  Â  .main-container {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  z-index: 10;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 42rem; /* Ukuran default (mobile) */
Â  Â  Â  Â  Â  Â  margin-top: 4rem;
Â  Â  Â  Â  Â  Â  margin-bottom: 4rem;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  /* --- EFEK BARU: GLASSMORPHISM --- */
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.5);
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 16px -> 10px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  /* --- AKHIR EFEK BARU --- */

Â  Â  Â  Â  Â  Â  border-radius: 1.5rem; /* rounded-2xl, lebih halus */
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  transition: background-color 300ms;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  /* 3. The key CSS property for the glass effect */
Â  Â  Â  Â  .main-container {
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 10px -> 6px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(6px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(6px); /* For Safari browser compatibility */

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  /* PERUBAHAN: Perbesar kontainer di Desktop (lg) untuk 2 kolom */
Â  Â  Â  Â  @media (min-width: 1024px) {
Â  Â  Â  Â  Â  Â  .main-container {
Â  Â  Â  Â  Â  Â  Â  Â  max-width: 64rem; /* max-w-6xl */
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  @media (min-width: 768px) {
Â  Â  Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  .main-container {
Â  Â  Â  Â  Â  Â  Â  Â  Â margin-top: 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â margin-bottom: 0;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- EFEK FADE (DIPERBARUI) --- */
Â  Â  Â  Â  #menu-container, #quiz-container, #score-container, #question-area {
Â  Â  Â  Â  Â  Â  transition: opacity 350ms ease-in-out, transform 350ms ease-in-out; /* BARU: Tambah transform, percepat */
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-backdrop, .modal-container {
Â  Â  Â  Â  Â  Â  Â transition: opacity 300ms ease-in-out, transform 300ms ease-in-out;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* State saat disembunyikan (untuk transisi) */
Â  Â  Â  Â  .modal-backdrop.hidden, .modal-container.hidden {
Â  Â  Â  Â  Â  Â  Â pointer-events: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* BARU: State awal (visible) */
Â  Â  Â  Â  #menu-container, #quiz-container, #score-container, #question-area {
Â  Â  Â  Â  Â  Â  transform: scale(1) translateY(0px);
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* BARU: State (hidden) untuk transisi scale-down + slide up */
Â  Â  Â  Â  #menu-container.opacity-0,Â 
Â  Â  Â  Â  #quiz-container.opacity-0,Â 
Â  Â  Â  Â  #score-container.opacity-0 {
Â  Â  Â  Â  Â  Â  transform: translateY(20px) scale(0.98); /* Mulai dari bawah */
Â  Â  Â  Â  Â  Â  opacity: 0;Â 
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* BARU: State (keluar) untuk transisi slide up */
Â  Â  Â  Â  .slide-out-up {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transform: translateY(-20px) scale(0.98);
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* BARU: Animasi Staggered (Reveal) */
Â  Â  Â  Â  @keyframes reveal {
Â  Â  Â  Â  Â  Â  from {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translateY(20px);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  to {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translateY(0);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  .reveal-item {
Â  Â  Â  Â  Â  Â  opacity: 0; /* Mulai hidden */
Â  Â  Â  Â  Â  Â  animation: reveal 400ms ease-out forwards;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 

Â  Â  Â  Â  /* --- STYLING DARK MODE FIXES (Perbaikan Tambahan) --- */
Â  Â  Â  Â  body.dark {
Â  Â  Â  Â  Â  Â  color: #f3f4f6; /* Default text color in dark mode */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #bg-canvas {
Â  Â  Â  Â  Â  Â  background-color: #191970; /* gray-900 */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .main-container, body.dark .modal-container {
Â  Â  Â  Â  Â  Â  /* --- EFEK BARU: GLASSMORPHISM (DARK) --- */
Â  Â  Â  Â  Â  Â  background-color: rgba(31, 41, 55, 0.5);
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 16px -> 10px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Fallback untuk browser (Firefox) yang tidak support backdrop-filter */
Â  Â  Â  Â  @supports not (backdrop-filter: blur(10px)) { /* DIUBAH: 16px -> 10px */
Â  Â  Â  Â  Â  Â  .main-container, .modal-container {
Â  Â  Â  Â  Â  Â  Â  Â  background-color: #ffffff;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  body.dark .main-container, body.dark .modal-container {
Â  Â  Â  Â  Â  Â  Â  Â  background-color: #1f2937; /* gray-800 */
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }


Â  Â  Â  Â  /* Memperbaiki warna teks umum, termasuk h4 di menu dan modal */
Â  Â  Â  Â  body.dark h1, body.dark h2, body.dark h3, body.dark h4, body.dark p, body.dark strong, body.dark #question-text, body.dark #modal-nav-title {
Â  Â  Â  Â  Â  Â  color: #f3f4f6; /* white-ish */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .text-slate-700 {
Â  Â  Â  Â  Â  Â  color: #d1d5db; /* light gray for secondary text */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* FIX: Tombol Kembali ke Menu di Kuis */
Â  Â  Â  Â  body.dark #back-to-menu-quiz-btn {Â 
Â  Â  Â  Â  Â  Â  Â color: #93c5fd; /* blue-300 agar terlihat */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #loading-spinner p, body.dark #question-counter {
Â  Â  Â  Â  Â  Â  color: #9ca3af; /* gray-400 */
Â  Â  Â  Â  Â  Â  background-color: #374151; /* gray-700 */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- EFEK BARU: Button Interaktif --- */
Â  Â  Â  Â  .interactive-btn {
Â  Â  Â  Â  Â  Â  transition: all 0.2s ease-out;
Â  Â  Â  Â  Â  Â  border: none; /* Hilangkan border default jika ada */
Â  Â  Â  Â  Â  Â  /* PERBAIKAN: Shadow lebih kuat untuk "Depth" */
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
Â  Â  Â  Â  }
Â  Â  Â  Â  .interactive-btn:hover {
Â  Â  Â  Â  Â  Â  transform: translateY(-2px); /* Efek 'lift' */
Â  Â  Â  Â  Â  Â  filter: brightness(1.1);
Â  Â  Â  Â  Â  Â  /* PERBAIKAN: Shadow lebih kuat untuk "Depth" */
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
Â  Â  Â  Â  }
Â  Â  Â  Â  .interactive-btn:active {
Â  Â  Â  Â  Â  Â  transform: scale(0.98) translateY(0px); /* Efek 'press' */
Â  Â  Â  Â  Â  Â  filter: brightness(0.9);
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .interactive-btn:hover {
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- EFEK BARU: GRADIENT UNTUK TOMBOL (LEBIH JELAS) --- */
Â  Â  Â  Â  #start-btn, #finish-btn, #confirm-finish-btn {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #34d399, #10b981); /* Emerald-400 ke Emerald-500 */
Â  Â  Â  Â  }
Â  Â  Â  Â  #start-btn:hover, #finish-btn:hover, #confirm-finish-btn:hover {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #059669, #0f766e); /* Emerald-600 ke Teal-700 */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #next-btn, #reset-btn {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #0ea5e9, #3b82f6); /* Sky-500 ke Blue-500 */
Â  Â  Â  Â  }
Â  Â  Â  Â  #next-btn:hover, #reset-btn:hover {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #0284c7, #2563eb); /* Sky-600 ke Blue-600 */
Â  Â  Â  Â  }

Â  Â  Â  Â  #review-btn {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #d946ef, #a855f7); /* Fuchsia-500 ke Purple-500 */
Â  Â  Â  Â  }
Â  Â  Â  Â  #review-btn:hover {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #c026d3, #9333ea); /* Fuchsia-600 ke Purple-600 */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #review-back-btn, #cancel-finish-btn {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #f43f5e, #ef4444); /* Rose-500 ke Red-500 */
Â  Â  Â  Â  }
Â  Â  Â  Â  #review-back-btn:hover, #cancel-finish-btn:hover {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #e11d48, #dc2626); /* Rose-600 ke Red-600 */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #back-to-menu-score-btn {
Â  Â  Â  Â  Â  Â  background-color: #e5e7eb; /* slate-200 */
Â  Â  Â  Â  }
Â  Â  Â  Â  #back-to-menu-score-btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #d1d5db; /* slate-300 */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #back-to-menu-score-btn {
Â  Â  Â  Â  Â  Â  background-color: #374151; /* gray-700 */
Â  Â  Â  Â  Â  Â  color: #f3f4f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #back-to-menu-score-btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #4b5563; /* gray-600 */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- AKHIR EFEK BARU --- */

Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  /* --- PERBAIKAN: Tombol Pilihan Ganda (Glassmorphism) --- */
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  .option-btn {
Â  Â  Â  Â  Â  Â  transition: all 0.2s ease-out; /* DIPERBARUI: Transisi untuk hover */
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.3); /* KACA */
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.4); /* Border Kaca */
Â  Â  Â  Â  Â  Â  border-radius: 0.75rem; /* rounded-xl */
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); /* Shadow "Depth" */
Â  Â  Â  Â  }
Â  Â  Â  Â  .option-btn:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.02); /* Efek pop */
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.5); /* Lebih cerah */
Â  Â  Â  Â  Â  Â  border-color: rgba(255, 255, 255, 0.6);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body.dark .option-btn {
Â  Â  Â  Â  Â  Â  background-color: rgba(55, 65, 81, 0.3); /* KACA (Dark) */
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.1); /* Border Kaca (Dark) */
Â  Â  Â  Â  Â  Â  color: #f3f4f6;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); /* Shadow "Depth" (Dark) */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .option-btn:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.02); /* Efek pop */
Â  Â  Â  Â  Â  Â  background-color: rgba(55, 65, 81, 0.5); /* Lebih cerah (Dark) */
Â  Â  Â  Â  Â  Â  border-color: rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  }
Â  Â  Â  Â  /* ========================================================== */

Â  Â  Â  Â  body.dark .q-nav-unanswered:hover {
Â  Â  Â  Â  Â  Â  background-color: #4b5563;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Style kotak wacana di Dark Mode */
Â  Â  Â  Â  body.dark #passage-container {
Â  Â  Â  Â  Â  Â  background-color: #374151;
Â  Â  Â  Â  Â  Â  border-color: #4b5563;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #passage-container * {
Â  Â  Â  Â  Â  Â  Â color: #f3f4f6 !important; /* Memastikan semua teks di wacana putih */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Style kotak Penjelasan di Dark Mode (Kontras Tinggi) */
Â  Â  Â  Â  body.dark .explanation-correct {
Â  Â  Â  Â  Â  Â  background-color: #064e3b; /* deep green background */
Â  Â  Â  Â  Â  Â  border-color: #34d399;Â  Â  Â /* bright green border */
Â  Â  Â  Â  Â  Â  color: #d1fae5;Â  Â  Â  Â  Â  Â  /* light green text */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .explanation-wrong {
Â  Â  Â  Â  Â  Â  background-color: #7f1d1d; /* deep red background */
Â  Â  Â  Â  Â  Â  border-color: #f87171;Â  Â  Â /* bright red border */
Â  Â  Â  Â  Â  Â  color: #fee2e2;Â  Â  Â  Â  Â  Â  /* light red text */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* FIX KRITIS: Tombol Navigasi Kuis (Sebelumnya/Berikutnya) di Dark Mode */
Â  Â  Â  Â  body.dark #prev-btn {
Â  Â  Â  Â  Â  Â  background-color: #374151; /* abu-abu gelap */
Â  Â  Â  Â  Â  Â  color: #f3f4f6;
Â  Â  Â  Â  Â  Â  border-color: #4b5563;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #prev-btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #4b5563;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body.dark #next-btn {
Â  Â  Â  Â  Â  Â  Â /* Warna BIRU tetap untuk tombol Next/Lihat Skor */
Â  Â  Â  Â  Â  Â  Â background-image: linear-gradient(to right, #0ea5e9, #3b82f6); /* BARU: GRADIENT */
Â  Â  Â  Â  Â  Â  Â color: white !important;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #next-btn:hover {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #0284c7, #2563eb);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Nonaktifkan tombol next/prev di dark mode */
Â  Â  Â  Â  body.dark #prev-btn:disabled, body.dark #next-btn:disabled {
Â  Â  Â  Â  Â  Â  background-color: #374151;
Â  Â  Â  Â  Â  Â  background-image: none; /* Hapus gradient saat disabled */
Â  Â  Â  Â  Â  Â  opacity: 0.5;
Â  Â  Â  Â  Â  Â  box-shadow: none;
Â  Â  Â  Â  Â  Â  transform: none;
Â  Â  Â  Â  Â  Â  filter: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Tombol Musik TEMA di Menu Utama */
Â  Â  Â  Â  .music-toggle-btn {
Â  Â  Â  Â  Â  Â  padding: 10px 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  transition: all 300ms ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  .music-toggle-btn.is-muted {
Â  Â  Â  Â  Â  Â  background-color: #fee2e2; /* red-100 */
Â  Â  Â  Â  Â  Â  color: #b91c1c; /* red-800 */
Â  Â  Â  Â  }
Â  Â  Â  Â  .music-toggle-btn.is-unmuted {
Â  Â  Â  Â  Â  Â  background-color: #dcfce7; /* green-100 */
Â  Â  Â  Â  Â  Â  color: #166534; /* green-800 */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Floating Controls (BARU) */
Â  Â  Â  Â  #floating-controls {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 20px;
Â  Â  Â  Â  Â  Â  right: 20px;
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  /* --- PERBAIKAN: Tombol Floating (Glassmorphism) --- */
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  .floating-icon-btn {
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.5);
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 9999px; /* rounded-full */
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.3);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
Â  Â  Â  Â  Â  Â  transition: all 300ms ease;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  width: 42px;Â 
Â  Â  Â  Â  Â  Â  height: 42px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .floating-icon-btn:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.1);
Â  Â  Â  Â  Â  Â  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
Â  Â  Â  Â  }
Â  Â  Â  Â  .floating-icon-btn:active {
Â  Â  Â  Â  Â  Â  transform: scale(0.95);
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .floating-icon-btn {
Â  Â  Â  Â  Â  Â  background-color: rgba(55, 65, 81, 0.5);
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  color: #f3f4f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .floating-icon-btn:hover {
Â  Â  Â  Â  Â  Â  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
Â  Â  Â  Â  }
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- PERUBAHAN ANIMASI IKON --- */

Â  Â  Â  Â  /* Aturan umum untuk ikon di dalam tombol floating (POSISI + TRANSISI) */
Â  Â  Â  Â  .floating-icon-btn > svg {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  /* Transisi ditambahkan ke SEMUA ikon floating */
Â  Â  Â  Â  Â  Â  transition: opacity 300ms ease-in-out, transform 300ms ease-in-out;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Style ikon Tema (BARU DENGAN ANIMASI + WARNA) */
Â  Â  Â  Â  #theme-toggle-btn-floating {
Â  Â  Â  Â  Â  Â  Â color: #f59e0b; /* Kuning (Matahari) */
Â  Â  Â  Â  }
Â  Â  Â  Â  #theme-sun-icon {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) rotate(0deg) scale(1);
Â  Â  Â  Â  }
Â  Â  Â  Â  #theme-moon-icon {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) rotate(-90deg) scale(0.5);
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Saat Dark Mode Aktif */
Â  Â  Â  Â  body.dark #theme-toggle-btn-floating {
Â  Â  Â  Â  Â  Â  Â color: #60a5fa; /* Biru (Bulan) */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #theme-sun-icon {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) rotate(90deg) scale(0.5);
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #theme-moon-icon {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) rotate(0deg) scale(1);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Style ikon Musik (Volume) (TETAP DENGAN ANIMASI) */
Â  Â  Â  Â Â 
Â  Â  Â  Â  #music-icon-unmuted { /* Gelombang */
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(0.5);
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-icon-muted { /* Silang */
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(1);
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-toggle-btn-floating.is-unmuted #music-icon-unmuted {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(1);
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-toggle-btn-floating.is-unmuted #music-icon-muted {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) scale(0.5);
Â  Â  Â  Â  }
Â  Â  Â  Â  /* --- AKHIR PERUBAHAN ANIMASI --- */


Â  Â  Â  Â  /* Style kustom untuk tombol pilihan */
Â  Â  Â  Â  .option-btn:disabled {
Â  Â  Â  Â  Â  Â  /* PERUBAHAN: Tombol tidak lagi di-disable saat kuis */
Â  Â  Â  Â  Â  Â  /* opacity: 1;Â 
Â  Â  Â  Â  Â  Â  cursor: not-allowed; */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* BARU: Style untuk Pilihan yang Dipilih (Mode Kuis Normal) */
Â  Â  Â  Â  .selected-answer {
Â  Â  Â  Â  Â  Â  background-color: #dbeafe; /* blue-100 */
Â  Â  Â  Â  Â  Â  border-color: #2563eb; /* blue-600 */
Â  Â  Â  Â  Â  Â  color: #1e3a8a; /* blue-900 */
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  transform: scale(1.02);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .selected-answer {
Â  Â  Â  Â  Â  Â  background-color: #1e3a8a !important; /* blue-900 */
Â  Â  Â  Â  Â  Â  border-color: #60a5fa !important; /* blue-300 */
Â  Â  Â  Â  Â  Â  color: #eff6ff !important; /* blue-50 */
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(96, 165, 250, 0.3);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Kelas untuk jawaban benar */
Â  Â  Â  Â  .correct-answer {
Â  Â  Â  Â  Â  Â  background-color: #dcfce7; /* green-100 */
Â  Â  Â  Â  Â  Â  border-color: #22c55e; /* green-500 */
Â  Â  Â  Â  Â  Â  color: #166534; /* green-800 */
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  transform: translateX(0px) scale(1.02);
Â  Â  Â  Â  Â  Â  border-width: 2px;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* FIX KRITIS: Jawaban Benar di Dark Mode */
Â  Â  Â  Â  body.dark .correct-answer {
Â  Â  Â  Â  Â  Â  background-color: #064e3b !important; /* Hijau Tua */
Â  Â  Â  Â  Â  Â  border-color: #34d399 !important;Â  Â  Â /* Garis Hijau Muda */
Â  Â  Â  Â  Â  Â  color: #d1fae5 !important;Â  Â  Â  Â  Â  Â  /* Teks Hijau Sangat Muda */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Kelas untuk jawaban salah yang dipilih */
Â  Â  Â  Â  .wrong-answer {
Â  Â  Â  Â  Â  Â  background-color: #fee2e2; /* red-100 */
Â  Â  Â  Â  Â  Â  border-color: #ef4444; /* red-500 */
Â  Â  Â  Â  Â  Â  color: #991b1b; /* red-800 */
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  transform: translateX(0px) scale(1.02);
Â  Â  Â  Â  Â  Â  border-width: 2px;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* FIX KRITIS: Jawaban Salah di Dark Mode */
Â  Â  Â  Â  body.dark .wrong-answer {
Â  Â  Â  Â  Â  Â  background-color: #7f1d1d !important; /* Merah Tua */
Â  Â  Â  Â  Â  Â  border-color: #f87171 !important;Â  Â  Â /* Garis Merah Muda */
Â  Â  Â  Â  Â  Â  color: #fee2e2 !important;Â  Â  Â  Â  Â  Â  /* Teks Merah Sangat Muda */
Â  Â  Â  Â  }


Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  /* --- PERBAIKAN: Tombol Mata Pelajaran (Glassmorphism) --- */
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  .subject-active {
Â  Â  Â  Â  Â  Â  background-image: linear-gradient(to right, #0ea5e9, #3b82f6); /* GRADIENT BIRU */
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  }
Â  Â  Â  Â  .subject-inactive {
Â  Â  Â  Â  Â  Â  background-color: rgba(229, 231, 235, 0.3); /* KACA */
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.4);
Â  Â  Â  Â  Â  Â  color: #374151; /* slate-700 */
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .subject-inactive {
Â  Â  Â  Â  Â  Â  Â background-color: rgba(55, 65, 81, 0.3); /* KACA (Dark) */
Â  Â  Â  Â  Â  Â  Â /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  Â backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  Â -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  Â border: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  Â color: #f3f4f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .subject-inactive:hover {
Â  Â  Â  Â  Â  Â  background-color: rgba(55, 65, 81, 0.5); /* Lebih cerah (Dark) */
Â  Â  Â  Â  }
Â  Â  Â  Â  .subject-inactive:hover {
Â  Â  Â  Â  Â  Â  background-color: rgba(229, 231, 235, 0.5); /* Lebih cerah */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* ========================================================== */


Â  Â  Â  Â  /* Styling untuk Panel Navigasi Soal (PERUBAHAN FONT) */
Â  Â  Â  Â  .q-nav-btn {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  aspect-ratio: 1 / 1;Â 
Â  Â  Â  Â  Â  Â  height: auto;
Â  Â  Â  Â  Â  Â  border-radius: 0.375rem;
Â  Â  Â  Â  Â  Â  font-family: 'Montserrat', sans-serif; /* Font Baru */
Â  Â  Â  Â  Â  Â  font-size: 1.125rem; /* Diperbesar (text-lg) */
Â  Â  Â  Â  Â  Â  font-weight: 700; /* Bold */
Â  Â  Â  Â  Â  Â  transition: all 0.2s;
Â  Â  Â  Â  Â  Â  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* "Depth" */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  /* --- PERBAIKAN ANIMASI SCALE DAFTAR SOAL --- */
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  .q-nav-btn:active {
Â  Â  Â  Â  Â  Â  transform: scale(0.95);
Â  Â  Â  Â  Â  Â  filter: brightness(0.9);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERBAIKAN: Tombol Daftar Soal (Glassmorphism) */
Â  Â  Â  Â  .q-nav-unanswered {
Â  Â  Â  Â  Â  Â  background-color: rgba(226, 232, 240, 0.3); /* KACA */
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.4);
Â  Â  Â  Â  Â  Â  color: #334155;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .q-nav-unanswered {
Â  Â  Â  Â  Â  Â  background-color: rgba(55, 65, 81, 0.3); /* KACA (Dark) */
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 8px -> 5px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  color: #f3f4f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  .q-nav-unanswered:hover {
Â  Â  Â  Â  Â  Â  background-color: rgba(203, 213, 225, 0.5);
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .q-nav-unanswered:hover {
Â  Â  Â  Â  Â  Â  background-color: rgba(55, 65, 81, 0.5);
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* BARU: Style untuk navigasi yang sudah dijawab (Mode Kuis) */
Â  Â  Â  Â  .q-nav-answered-quiz {
Â  Â  Â  Â  Â  Â  background-color: #60a5fa; /* blue-400 */
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .q-nav-answered-quiz:hover {
Â  Â  Â  Â  Â  Â  background-color: #3b82f6; /* blue-500 */
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .q-nav-answered-quiz {
Â  Â  Â  Â  Â  Â  background-color: #2563eb; /* blue-600 */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark .q-nav-answered-quiz:hover {
Â  Â  Â  Â  Â  Â  background-color: #1d4ed8; /* blue-700 */
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .q-nav-answered { /* Mode Review: Benar */
Â  Â  Â  Â  Â  Â  background-color: #22c55e;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .q-nav-answered:hover {
Â  Â  Â  Â  Â  Â  background-color: #16a34a;
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â  .q-nav-wrong-answered { /* Mode Review: Salah */
Â  Â  Â  Â  Â  Â  background-color: #ef4444;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .q-nav-wrong-answered:hover {
Â  Â  Â  Â  Â  Â  background-color: #dc2626;
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERUBAHAN: Tombol Aktif (Kuning) */
Â  Â  Â  Â  .q-nav-active {Â 
Â  Â  Â  Â  Â  Â  background-color: #f59e0b; /* amber-500 */
Â  Â  Â  Â  Â  Â  color: #1f2937; /* gray-800, text-gray-800 */
Â  Â  Â  Â  Â  Â  outline: 2px solid #f59e0b; /* amber-500 */
Â  Â  Â  Â  Â  Â  outline-offset: 2px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .q-nav-active:hover {
Â  Â  Â  Â  Â  Â  transform: translateY(0px); /* Jangan terangkat saat aktif */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* ========================================================== */

Â  Â  Â  Â  /* Panel Navigasi (Modal dan Desktop) */
Â  Â  Â  Â  #quiz-nav-panel, #desktop-nav-panel {
Â  Â  Â  Â  Â  Â  display: grid; /* <-- PERBAIKAN: Menambahkan display grid */
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(6, minmax(0, 1fr));
Â  Â  Â  Â  Â  Â  gap: 0.5rem; /* gap-2 */
Â  Â  Â  Â  Â  Â  padding: 0.75rem; /* p-3 */
Â  Â  Â  Â  Â  Â  /* Hapus background solid, biarkan transparan (karena modal-nya sudah glass) */
Â  Â  Â  Â  Â  Â  /* background-color: #f9fafb; */Â 
Â  Â  Â  Â  Â  Â  border-radius: 0.5rem; /* rounded-lg */
Â  Â  Â  Â  Â  Â  /* border-width: 1px; */ /* Hapus border */
Â  Â  Â  Â  Â  Â  max-height: 16rem; /* max-h-64 */
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* PERBAIKAN: Latar Belakang Panel Navigasi Soal di Dark Mode */
Â  Â  Â  Â  body.dark #quiz-nav-panel,Â 
Â  Â  Â  Â  body.dark #desktop-nav-panel {
Â  Â  Â  Â  Â  Â  /* background-color: #1f2937; */ /* Hapus background solid */
Â  Â  Â  Â  Â  Â  /* border-color: #374151; */ /* Hapus border */
Â  Â  Â  Â  Â  Â  /* BARU: Styling Scrollbar Firefox */
Â  Â  Â  Â  Â  Â  scrollbar-color: #4b5563 #1f2937; /* thumb(gray-600) track(gray-800) */
Â  Â  Â  Â  Â  Â  scrollbar-width: auto; /* PERBAIKAN: Diubah dari 'thin' ke 'auto' */
Â  Â  Â  Â  }
Â  Â Â 
Â  Â  Â  Â  /* BARU: Styling Scrollbar Webkit (Chrome, Safari) */
Â  Â  Â  Â  body.dark #quiz-nav-panel::-webkit-scrollbar,
Â  Â  Â  Â  body.dark #desktop-nav-panel::-webkit-scrollbar {
Â  Â  Â  Â  Â  Â  width: 16px; /* PERBAIKAN: Diperbesar dari 8px ke 16px */
Â  Â  Â  Â  }
Â  Â Â 
Â  Â  Â  Â  body.dark #quiz-nav-panel::-webkit-scrollbar-track,
Â  Â  Â  Â  body.dark #desktop-nav-panel::-webkit-scrollbar-track {
Â  Â  Â  Â  Â  Â  background: #1f2937; /* gray-800 */
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  }
Â  Â Â 
Â  Â  Â  Â  body.dark #quiz-nav-panel::-webkit-scrollbar-thumb,
Â  Â  Â  Â  body.dark #desktop-nav-panel::-webkit-scrollbar-thumb {
Â  Â  Â  Â  Â  Â  background-color: #4b5563; /* gray-600 */
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  border: 4px solid #1f2937; /* PERBAIKAN: Disesuaikan agar pas 16px */
Â  Â  Â  Â  }
Â  Â Â 
Â  Â  Â  Â  body.dark #quiz-nav-panel::-webkit-scrollbar-thumb:hover,
Â  Â  Â  Â  body.dark #desktop-nav-panel::-webkit-scrollbar-thumb:hover {
Â  Â  Â  Â  Â  Â  background-color: #6b7280; /* gray-500 */
Â  Â  Â  Â  }

Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  /* --- PERBAIKAN SCROLLBAR WACANA (DARK MODE) --- */
Â  Â  Â  Â  /* ========================================================== */
Â  Â  Â  Â  body.dark #passage-container {
Â  Â  Â  Â  Â  Â  /* Firefox */
Â  Â  Â  Â  Â  Â  scrollbar-color: #4b5563 #374151; /* thumb(gray-600) track(gray-700) */
Â  Â  Â  Â  Â  Â  scrollbar-width: auto; /* <--- DIUBAH DARI thin */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #passage-container::-webkit-scrollbar {
Â  Â  Â  Â  Â  Â  width: 16px; /* <--- DIUBAH DARI 8px */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #passage-container::-webkit-scrollbar-track {
Â  Â  Â  Â  Â  Â  background: #374151; /* gray-700 */
Â  Â  Â  Â  Â  Â  border-radius: 10px; /* <--- DIUBAH DARI 4px */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #passage-container::-webkit-scrollbar-thumb {
Â  Â  Â  Â  Â  Â  background-color: #4b5563; /* <--- DIUBAH (samakan dgn panel) */
Â  Â  Â  Â  Â  Â  border-radius: 10px; /* <--- DIUBAH DARI 4px */
Â  Â  Â  Â  Â  Â  border: 4px solid #374151; /* <--- DITAMBAH (pakai track color gray-700) */
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #passage-container::-webkit-scrollbar-thumb:hover {
Â  Â  Â  Â  Â  Â  background-color: #6b7280; /* <--- DIUBAH (samakan dgn panel) */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* --- AKHIR PERBAIKAN SCROLLBAR WACANA --- */


Â  Â  Â  Â  /* Backdrop & Modal (Menggunakan modal-backdrop yang sama) */
Â  Â  Â  Â  .modal-backdrop {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100vw;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  background-color: rgba(0, 0, 0, 0.5); /* Latar redup */
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 16px -> 10px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px); /* Efek blur DITINGKATKAN */
Â  Â  Â  Â  Â  Â  z-index: 40;
Â  Â  Â  Â  Â  Â  /* opacity: 0; <-- DIHAPUS, dikontrol oleh class Tailwind */
Â  Â  Â  Â  Â  Â  transition: opacity 300ms ease-in-out;
Â  Â  Â  Â  Â  Â  pointer-events: none; /* Nonaktifkan klik saat transisi */
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-container {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  z-index: 50;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 32rem;Â 
Â  Â  Â  Â  Â  Â  /* opacity: 0; <-- DIHAPUS, dikontrol oleh class Tailwind */
Â  Â  Â  Â  Â  Â  transition: opacity 300ms ease-in-out, transform 300ms ease-in-out;
Â  Â  Â  Â  Â  Â  pointer-events: none; /* Nonaktifkan klik saat transisi */
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.5);
Â  Â  Â  Â  Â  Â  /* PERUBAHAN BLUR: 16px -> 10px */
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  border-radius: 1.5rem; /* rounded-2xl */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Aktifkan klik saat modal terlihat */
Â  Â  Â  Â  .modal-backdrop:not(.hidden), .modal-container:not(.hidden) {
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .explanation-correct {
Â  Â  Â  Â  Â  Â  background-color: #dcfce7;
Â  Â  Â  Â  Â  Â  border-color: #bbf7d0;Â 
Â  Â  Â  Â  Â  Â  color: #15803d;
Â  Â  Â  Â  }
Â  Â  Â  Â  .explanation-wrong {
Â  Â  Â  Â  Â  Â  background-color: #fee2e2;
Â  Â  Â  Â  Â  Â  border-color: #fecaca;
Â  Â  Â  Â  Â  Â  color: #b91c1c;
Â  Â  Â  Â  }

Â  Â  Â  Â  #loading-spinner svg {
Â  Â  Â  Â  Â  Â  animation: spin 1s linear infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes spin {
Â  Â  Â  Â  Â  Â  from { transform: rotate(0deg); }
Â  Â  Â  Â  Â  Â  to { transform: rotate(360deg); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Style untuk wacana/passage */
Â  Â  Â  Â  #passage-content {
Â  Â  Â  Â  Â  Â  white-space: pre-wrap;Â 
Â  Â  Â  Â  Â  Â  font-family: 'Georgia', 'Times New Roman', serif;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* PERBAIKAN: CSS untuk Responsif Teks Matematika */
Â  Â  Â  Â  #question-text, .option-btn, #explanation-text, #passage-content {
Â  Â  Â  Â  Â  Â  overflow-x: auto; /* Memungkinkan scroll horizontal JIKA perlu */
Â  Â  Â  Â  Â  Â  overflow-wrap: break-word; /* Memaksa kata-kata normal untuk pecah */
Â  Â  Â  Â  Â  Â  word-wrap: break-word; /* Fallback */
Â  Â  Â  Â  Â  Â  -ms-word-break: break-all;
Â  Â  Â  Â  Â  Â  word-break: break-all; /* Paling agresif */
Â  Â  Â  Â  Â  Â  word-break: break-word; /* Standar modern */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Styling Scrollbar horizontal (jika muncul) */
Â  Â  Â  Â  #question-text::-webkit-scrollbar,
Â  Â  Â  Â  .option-btn::-webkit-scrollbar,
Â  Â  Â  Â  #explanation-text::-webkit-scrollbar,
Â  Â  Â  Â  #passage-content::-webkit-scrollbar {
Â  Â  Â  Â  Â  Â  height: 6px;
Â  Â  Â  Â  }
Â  Â  Â  Â  #question-text::-webkit-scrollbar-thumb,
Â  Â  Â  Â  .option-btn::-webkit-scrollbar-thumb,
Â  Â  Â  Â  #explanation-text::-webkit-scrollbar-thumb,
Â  Â  Â  Â  #passage-content::-webkit-scrollbar-thumb {
Â  Â  Â  Â  Â  Â  background: #cbd5e1;
Â  Â  Â  Â  Â  Â  border-radius: 3px;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark #question-text::-webkit-scrollbar-thumb,
Â  Â  Â  Â  body.dark .option-btn::-webkit-scrollbar-thumb,
Â  Â  Â  Â  body.dark #explanation-text::-webkit-scrollbar-thumb,
Â  Â  Â  Â  body.dark #passage-content::-webkit-scrollbar-thumb {
Â  Â  Â  Â  Â  Â  background: #4b5563;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body class="p-4">
Â  Â Â 
Â  Â  <canvas id="bg-canvas"></canvas>

Â  Â  <!-- ELEMEN AUDIO MP3 -->
Â  Â  <audio id="bg-music" src="./assets/musikku.mp3" loop muted></audio>

Â  Â  <!-- FLOATING CONTROLS (SELALU TERLIHAT) -->
Â  Â  <div id="floating-controls">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <!-- 1. Auto-Tema (DIHAPUS) -->
Â  Â  Â  Â  <!-- <button id="theme-auto-btn" ...> ... </button> -->

Â  Â  Â  Â  <!-- 2. Pilihan Tema (Toggle) -->
Â  Â  Â  Â  <button id="theme-toggle-btn-floating" class="floating-icon-btn">
Â  Â  Â  Â  Â  Â  <!-- Icon Sun (Default) -->
Â  Â  Â  Â  Â  Â  <svg id="theme-sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
Â  Â  Â  Â  Â  Â  <!-- Icon Moon (PERUBAHAN: class hidden dihapus) -->
Â  Â  Â  Â  Â  Â  <svg id="theme-moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <!-- 2. Musik Latar (PERUBAHAN: Konten diubah) -->
Â  Â  Â  Â  <button id="music-toggle-btn-floating" class="floating-icon-btn is-muted">
Â  Â  Â  Â  Â  Â  <!-- Ikon Unmuted (Gelombang) BARU -->
Â  Â  Â  Â  Â  Â  <svg id="music-icon-unmuted" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
Â  Â  Â  Â  Â  Â  <!-- Ikon Muted (Silang) BARU -->
Â  Â  Â  Â  Â  Â  <svg id="music-icon-muted" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="22" x2="16" y1="9" y2="15"/><line x1="16" x2="22" y1="9" y2="15"/></svg>
Â  Â  Â  Â  </button>
Â  Â  </div>
Â  Â  <!-- END FLOATING CONTROLS -->


Â  Â  <!-- PERBAIKAN: Padding diubah (p-4 sm:p-6) -->
Â  Â  <div class="main-container p-4 sm:p-6 rounded-2xl shadow-2xl">

Â  Â  Â  Â  <!-- 1. Kontainer Menu (Mulai visible) -->
Â  Â  Â  Â  <div id="menu-container" class="opacity-100">
Â  Â  Â  Â  Â  Â  <h1 class="text-3xl font-bold text-center text-slate-800 mb-6">Kuis Kelas X Semester 1</h1>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <h2 class="text-lg font-semibold text-slate-700 mb-3">Pilih Mata Pelajaran:</h2>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <!-- Spinner Pemuatan -->
Â  Â  Â  Â  Â  Â  <div id="loading-spinner" class="flex flex-col items-center justify-center my-6">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-sm text-slate-600">Memuat daftar pelajaran...</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <!-- Tombol subjek dinamis -->
Â  Â  Â  Â  Â  Â  <!-- BARU: Diubah jadi grid -->
Â  Â  Â  Â  Â  Â  <div id="subject-button-container" class="grid grid-cols-2 sm:grid-cols-3 gap-3 mb-6 hidden">
Â  Â  Â  Â  Â  Â  Â  Â  <!-- Tombol akan di-generate oleh JavaScript -->
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button id="start-btn" class="interactive-btn w-full bg-green-600 text-white px-6 py-4 rounded-lg font-bold text-lg hover:bg-green-700 transition-all hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Mulai Kuis
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <!-- 2. Kontainer Kuis (Mulai invisible dan hidden) -->
Â  Â  Â  Â  <div id="quiz-container" class="opacity-0 hidden">
Â  Â  Â  Â  Â  Â  <!-- Header (Judul & Kembali) -->
Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  <h1 id="quiz-title" class="text-xl font-bold text-slate-800">Kuis</h1>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center gap-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="timer-display" class="text-lg font-semibold text-red-600 bg-red-100 px-3 py-1 rounded-md">80:00</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- PERUBAHAN: Tombol Daftar Soal hilang di desktop (lg:hidden) -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="open-nav-btn" class="text-sm text-white bg-blue-600 px-3 py-1 rounded-md hover:bg-blue-700 font-medium transition-all lg:hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Daftar Soal
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="back-to-menu-quiz-btn" class="text-sm text-blue-600 hover:underline">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Kembali ke Menu
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <!-- PERUBAHAN: Layout 2 Kolom di Desktop -->
Â  Â  Â  Â  Â  Â  <div class="lg:flex lg:gap-6">
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <!-- Kolom Kiri (Soal) -->
Â  Â  Â  Â  Â  Â  Â  Â  <div id="quiz-content" class="w-full lg:w-7/12">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- WACANA / TEKS SOAL -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="passage-container" class="mb-5 p-4 bg-gray-50 border rounded-lg max-h-48 overflow-y-auto hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="passage-title" class="font-bold text-sm text-gray-700 mb-2"></h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="passage-content" class="text-sm text-gray-800 leading-relaxed"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Spinner saat soal dimuat -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="question-loading-spinner" class="hidden flex-col items-center justify-center my-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-sm text-slate-600">Memuat soal...</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="question-area" class="opacity-0"> <!-- Mulai transisi fade di sini -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="question-counter" class="text-sm font-medium text-slate-600 bg-slate-200 px-3 py-1 rounded-full w-fit mb-4"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mb-5">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p id="question-text" class="text-lg font-semibold text-slate-900 leading-relaxed"></p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="options-container" class="flex flex-col gap-3"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Box Penjelasan -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="explanation-box" class="hidden mt-4 p-4 rounded-lg border">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p id="explanation-text" class="text-sm mt-1"></p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Tombol Navigasi B/S (Layout BARU - Mobile First) -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-col sm:flex-row sm:justify-between items-center mt-6 gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="prev-btn" class="interactive-btn bg-slate-300 text-slate-700 px-5 py-2 rounded-lg font-medium hover:bg-slate-400 transition-all disabled:opacity-50 w-full sm:w-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Sebelumnya
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Tombol Selesai (di tengah, order-first di mobile) -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="finish-btn" class="interactive-btn bg-green-600 text-white px-5 py-3 sm:py-2 rounded-lg font-bold hover:bg-green-700 transition-all w-full sm:w-auto order-first sm:order-none text-lg sm:text-base">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Selesai
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- BARU: Tombol Kembali dari Mode Review (Merah) -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="review-back-btn" class="interactive-btn hidden bg-red-500 text-white px-5 py-3 sm:py-2 rounded-lg font-bold hover:bg-red-600 transition-all w-full sm:w-auto order-first sm:order-none text-lg sm:text-base">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Kembali ke Menu Skor
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="next-btn" class="interactive-btn bg-blue-600 text-white px-5 py-2 rounded-lg font-medium hover:bg-blue-700 transition-all w-full sm:w-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Berikutnya
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <!-- Kolom Kanan (Navigasi Desktop) BARU -->
Â  Â  Â  Â  Â  Â  Â  Â  <div id="desktop-nav-container" class="hidden lg:block lg:w-5/12">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- ========================================================== -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- *** PERBAIKAN: Ganti text-slate-700 ke text-slate-900 *** -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- ========================================================== -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-semibold text-slate-900 mb-4 dark:text-gray-200">Daftar Soal</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Panel navigasi khusus desktop -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="desktop-nav-panel">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Nomor-nomor akan di-inject di sini oleh JS -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  </div> <!-- End 2 Kolom -->
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- 3. Kontainer Skor (Mulai invisible dan hidden) -->
Â  Â  Â  Â  <div id="score-container" class="opacity-0 hidden text-center">
Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-bold text-slate-800 mb-4">Kuis Selesai!</h2>
Â  Â  Â  Â  Â  Â  <p class="text-xl text-slate-700 mb-2">Skor Anda:</p>
Â  Â  Â  Â  Â  Â  <p id="score-text" class="text-5xl font-bold text-blue-600 mb-6"></p>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="flex flex-col sm:flex-row gap-3 justify-center">
Â  Â  Â  Â  Â  Â  Â  Â  <!-- PERUBAHAN: Tombol 'Lihat Pembahasan' diubah jadi ungu (purple) -->
Â  Â  Â  Â  Â  Â  Â  Â  <button id="review-btn" class="interactive-btn bg-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-purple-700 transition-all text-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Lihat Pembahasan
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="reset-btn" class="interactive-btn bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-all text-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Ulangi Kuis
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="back-to-menu-score-btn" class="interactive-btn bg-slate-300 text-slate-700 px-6 py-3 rounded-lg font-medium hover:bg-slate-400 transition-all text-lg">
to Â  Â  Â  Â  Â  Â  Â  Â  Â  Kembali ke Menu
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  </div>

Â  Â  <!-- 4. Modal Navigasi Soal (Tersembunyi) -->
Â  Â  <div id="modal-backdrop-nav" class="modal-backdrop hidden opacity-0"></div>
Â  Â  <!-- PERBAIKAN: Padding diubah (p-4 sm:p-6) -->
Â  Â  <div id="modal-container-nav" class="modal-container p-4 sm:p-6 hidden opacity-0">
Â  Â  Â  Â  <div class="flex justify-between items-center mb-4">
Â  Â  Â  Â  Â  Â  <h3 id="modal-nav-title" class="text-lg font-semibold text-slate-700">Daftar Soal</h3>
Â  Â  Â  Â  Â  Â  <!-- PERBAIKAN: Tombol (X) diubah menjadi balok merah muda/merah tua -->
Â  Â  Â  Â  Â  Â  <button id="close-nav-btn" class="p-1.5 rounded-md text-red-600 bg-red-100 hover:bg-red-200 dark:bg-red-800 dark:text-red-300 dark:hover:bg-red-700 transition-colors">
Â  Â  Â  Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="quiz-nav-panel">
Â  Â  Â  Â  Â  Â  <!-- Nomor-nomor akan di-inject di sini -->
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  <!-- 5. Modal Konfirmasi Selesai (BARU) -->
Â  Â  <div id="modal-backdrop-finish" class="modal-backdrop hidden opacity-0"></div>
Â  Â  <!-- PERBAIKAN: Padding diubah (p-4 sm:p-6) -->
Â  Â  <div id="modal-container-finish" class="modal-container p-4 sm:p-6 hidden opacity-0">
Â  Â  Â  Â  <h3 class="text-xl font-bold text-slate-800 mb-4">Konfirmasi Selesai</h3>
Â  Â  Â  Â  <p class="text-slate-700 mb-6">Anda yakin sudah mengerjakan semua soal dan mengeceknya?</p>
Â  Â  Â  Â  <div class="flex justify-end gap-3">
Â  Â  Â  Â  Â  Â  <!-- PERUBAHAN: Class diubah dari bg-slate-300 menjadi bg-red-500 (merah) -->
Â  Â  Â  Â  Â  Â  <button id="cancel-finish-btn" class="interactive-btn bg-red-500 text-white px-5 py-2 rounded-lg font-medium hover:bg-red-600 transition-all">
Â  Â  Â  Â  Â  Â  Â  Â  Eh, gajadi
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button id="confirm-finish-btn" class="interactive-btn bg-green-600 text-white px-5 py-2 rounded-lg font-medium hover:bg-green-700 transition-all">
Â  Â  Â  Â  Â  Â  Â  Â  Iya, udah nih
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  <script type="module">
Â  Â  Â  Â  // --- VARIABEL GLOBAL APLIKASI ---
Â  Â  Â  Â  let allSubjects = [];Â 
Â  Â  Â  Â  let quizzesCache = new Map();Â 
Â  Â  Â  Â  let currentQuestionIndex = 0;
Â  Â  Â  Â  let score = 0;
Â  Â  Â  Â  let userAnswers = [];Â 
Â  Â  Â  Â  let selectedSubjectId = null;Â 
Â  Â  Â  Â  let activeQuizData = [];Â 
Â  Â  Â  Â  let timerInterval = null;Â 
Â  Â  Â  Â  let remainingTime = 80 * 60;Â 
Â  Â  Â  Â  let audioInitialized = false;
Â  Â  Â  Â  let isReviewMode = false;Â 
Â  Â  Â  Â  let isUserMuted = true; // DEFAULT-NYA MUTE (sesuai permintaan)

Â  Â  Â  Â  const HIGH_VOLUME = 1.0; // Volume normal (Menu/Skor)
Â  Â  Â  Â  const LOW_VOLUME = 0.7; // Volume rendah (Saat kuis) - Ditingkatkan ke 0.7
Â  Â  Â  Â  // --- REFERENSI ELEMEN DOM ---
Â  Â  Â  Â  const menuContainer = document.getElementById('menu-container');
Â  Â  Â  Â  const quizContainer = document.getElementById('quiz-container');
Â  Â  Â  Â  const scoreContainer = document.getElementById('score-container');
Â  Â  Â  Â  const subjectButtonContainer = document.getElementById('subject-button-container');Â 
Â  Â  Â  Â  const startBtn = document.getElementById('start-btn');
Â  Â  Â  Â  const quizTitle = document.getElementById('quiz-title');
Â  Â  Â  Â  const questionCounter = document.getElementById('question-counter');
Â  Â  Â  Â  const questionText = document.getElementById('question-text');
Â  Â  Â  Â  const optionsContainer = document.getElementById('options-container');
Â  Â  Â  Â  const explanationBox = document.getElementById('explanation-box');
Â  Â  Â  Â  const explanationText = document.getElementById('explanation-text');
Â  Â  Â  Â  const prevBtn = document.getElementById('prev-btn');
Â  Â  Â  Â  const nextBtn = document.getElementById('next-btn');
Â  Â  Â  Â  const finishBtn = document.getElementById('finish-btn'); // Tombol Selesai BARU
Â  Â  Â  Â  const reviewBackBtn = document.getElementById('review-back-btn'); // Tombol Kembali Review BARU
Â  Â  Â  Â  const backToMenuQuizBtn = document.getElementById('back-to-menu-quiz-btn');
Â  Â  Â  Â  const scoreText = document.getElementById('score-text');
Â  Â  Â  Â  const resetBtn = document.getElementById('reset-btn');
Â  Â  Â  Â  const backToMenuScoreBtn = document.getElementById('back-to-menu-score-btn');
Â  Â  Â  Â  const reviewBtn = document.getElementById('review-btn');Â 

Â  Â  Â  Â  // ELEMEN AUDIO & SETTINGS BARU/DIUBAH
Â  Â  Â  Â  const bgMusic = document.getElementById('bg-music');
Â  Â  Â  Â  const musicToggleButtonFloating = document.getElementById('music-toggle-btn-floating'); // Tombol floating musik
Â  Â  Â  Â  // const musicIconFloating = document.getElementById('music-icon-floating'); // Dihapus, diganti 2 ikon
Â  Â  Â  Â  const themeToggleButtonFloating = document.getElementById('theme-toggle-btn-floating'); // Tombol floating tema
Â  Â  Â  Â  // const themeAutoBtn = document.getElementById('theme-auto-btn'); // Tombol Auto-Tema DIHAPUS
Â  Â  Â  Â  const themeSunIcon = document.getElementById('theme-sun-icon');
Â  Â  Â  Â  const themeMoonIcon = document.getElementById('theme-moon-icon');

Â  Â  Â  Â  // Modal Navigasi
Â  Â  Â  Â  const modalBackdropNav = document.getElementById('modal-backdrop-nav');
Â  Â  Â  Â  const modalContainerNav = document.getElementById('modal-container-nav');
Â  Â  Â  Â  const openNavBtn = document.getElementById('open-nav-btn');
Â  Â  Â  Â  const closeNavBtn = document.getElementById('close-nav-btn');
Â  Â  Â  Â  const modalNavTitle = document.getElementById('modal-nav-title');Â 
Â  Â  Â  Â  const quizNavPanel = document.getElementById('quiz-nav-panel');Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // PERUBAHAN: Panel navigasi desktop BARU
Â  Â  Â  Â  const desktopNavPanel = document.getElementById('desktop-nav-panel');Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Modal Konfirmasi Selesai (BARU)
Â  Â  Â  Â  const modalBackdropFinish = document.getElementById('modal-backdrop-finish');
Â  Â  Â  Â  const modalContainerFinish = document.getElementById('modal-container-finish');
Â  Â  Â  Â  const confirmFinishBtn = document.getElementById('confirm-finish-btn');
Â  Â  Â  Â  const cancelFinishBtn = document.getElementById('cancel-finish-btn');


Â  Â  Â  Â  const timerDisplay = document.getElementById('timer-display');
Â  Â  Â  Â  const loadingSpinner = document.getElementById('loading-spinner');
Â  Â  Â  Â  const questionLoadingSpinner = document.getElementById('question-loading-spinner');
Â  Â  Â  Â  const questionArea = document.getElementById('question-area');
Â  Â  Â  Â  const passageContainer = document.getElementById('passage-container');
Â  Â  Â  Â  const passageTitleEl = document.getElementById('passage-title');
Â  Â  Â  Â  const passageContentEl = document.getElementById('passage-content');

Â  Â  Â  Â  // --- SETUP AUDIO (TONE.JS HANYA UNTUK SFX) ---
Â  Â  Â  Â  // SFX Synths tidak akan di-mute oleh Tone.Master, sehingga selalu terdengar
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERUBAHAN: Membagi SFX Pop menjadi 3 nada */
Â  Â  Â  Â  const popSfxHigh = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.001, decay: 0.05, sustain: 0, release: 0.1 } }).toDestination(); // C6 - Nada tinggi (Next, Open)
Â  Â  Â  Â  const popSfxMid = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.001, decay: 0.05, sustain: 0, release: 0.1 } }).toDestination();Â  // G5 - Nada sedang (Pilihan Jawaban)
Â  Â  Â  Â  const popSfxLow = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.001, decay: 0.05, sustain: 0, release: 0.1 } }).toDestination();Â  Â // C5 - Nada rendah (Prev, Close)
Â  Â  Â  Â Â 
Â  Â  Â  Â  const correctSfx = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.01, decay: 0.1, sustain: 0, release: 0.1 } }).toDestination();
Â  Â  Â  Â  const wrongSfx = new Tone.FMSynth({ harmonicity: 8, modulationIndex: 2, oscillator: { type: 'square' }, envelope: { attack: 0.01, decay: 0.2, sustain: 0, release: 0.1 } }).toDestination();
Â  Â  Â  Â  const alarmSfx = new Tone.Synth({ oscillator: { type: 'sawtooth' }, envelope: { attack: 0.01, decay: 0.2, sustain: 0.1, release: 0.2 } }).toDestination();
Â  Â  Â  Â Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- FUNGSI AUDIO ---
Â  Â  Â  Â Â 
Â  Â  Â  Â  /**
Â  Â  Â  Â  Â * Menginisialisasi audio (SFX dan Unmute Musik) pada interaksi pertama user
Â  Â  Â  Â  Â */
Â  Â  Â  Â  async function initAudio() {
Â  Â  Â  Â  Â  Â  if (audioInitialized) return;
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await Tone.start();Â 
Â  Â  Â  Â  Â  Â  Â  Â  bgMusic.volume = HIGH_VOLUME;
Â  Â  Â  Â  Â  Â  Â  Â  audioInitialized = true;
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.warn("Audio gagal dimulai.", e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /**
Â  Â  Â  Â  Â * Memperbarui status mute musik secara global (ikon dan volume)
Â  Â  Â  Â  Â * @param {boolean} shouldMute - Status mute yang diinginkan.
Â  Â  Â  Â  Â */
Â  Â  Â  Â  function updateMusicState(shouldMute) {
Â  Â  Â  Â  Â  Â  isUserMuted = shouldMute;
Â  Â  Â  Â  Â  Â  // PENTING: Tone.Master.mute DIHILANGKAN agar SFX (pop, correct, wrong) selalu aktif
Â  Â  Â  Â  Â  Â  bgMusic.muted = shouldMute;Â 

Â  Â  Â  Â  Â  Â  // Update style tombol floating
Â  Â  Â  Â  Â  Â  musicToggleButtonFloating.classList.toggle('is-muted', shouldMute);
Â  Â  Â  Â  Â  Â  musicToggleButtonFloating.classList.toggle('is-unmuted', !shouldMute);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // PERUBAHAN: Ikon tidak lagi diubah via innerHTML, tapi via class di CSS
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Mengganti warna latar tombol floating (Merah/Hijau)
Â  Â  Â  Â  Â  Â  musicToggleButtonFloating.style.backgroundColor = shouldMute ? '#fee2e2' : '#dcfce7';Â 
Â  Â  Â  Â  Â  Â  musicToggleButtonFloating.style.color = shouldMute ? '#b91c1c' : '#166534';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Jika musik di-unmute (shouldMute=false), coba paksa main
Â  Â  Â  Â  Â  Â  if (!shouldMute) {
Â  Â  Â  Â  Â  Â  Â  Â  bgMusic.play().catch(e => console.warn("Play on unmute failed:", e));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  /**
Â  Â  Â  Â  Â * Mengatur volume MP3 saat masuk/keluar kuis
Â  Â  Â  Â  Â * @param {number} volume - HIGH_VOLUME atau LOW_VOLUME.
Â  Â  Â  Â  Â */
Â  Â  Â  Â  function setMusicVolume(volume) {
Â  Â  Â  Â  Â  Â  Â // Pastikan volume hanya diatur jika tidak di-mute oleh user
Â  Â  Â  Â  Â  Â  if (!isUserMuted) {
Â  Â  Â  Â  Â  Â  Â  Â  Â bgMusic.volume = volume;
Â  Â  _ Â  Â  Â  Â  }
Â  Â  Â  Â  }


Â  Â  Â  Â  // --- SETUP CANVAS BACKGROUND ---
Â  Â  Â  Â  const canvas = document.getElementById('bg-canvas');
Â  Â  Â  Â  const ctx = canvas.getContext('2d');
Â  Â  Â  Â  let particles = [];
Â  Â  Â  Â  function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
Â  Â  Â  Â  class Particle {
Â  Â  Â  Â  Â  Â  constructor() { this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.size = Math.random() * 15 + 10; this.speedX = Math.random() * 1 - 0.5; this.speedY = Math.random() * 1 - 0.5; this.type = Math.random() > 0.5 ? 'book' : 'pen';Â 
Â  Â  Â  Â  Â  Â  // Mengubah warna partikel agar tidak mengganggu kontras dark mode
Â  Â  Â  Â  Â  Â  this.color = document.body.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(59, 130, 246, 0.2)';
Â  Â  Â  Â  Â  Â  this.rotation = Math.random() * 360; }
Â  Â  Â  Â  Â  Â  update() { this.x += this.speedX; this.y += this.speedY; this.rotation += 0.1; if (this.x < 0 || this.x > canvas.width) this.speedX *= -1; if (this.y < 0 || this.y > canvas.height) this.speedY *= -1; }
Â  Â  Â  Â  Â  Â  draw() { ctx.save(); ctx.translate(this.x, this.y); ctx.rotate(this.rotation * Math.PI / 180); ctx.fillStyle = this.color; if (this.type === 'book') { ctx.fillRect(-this.size / 2, -this.size / 1.5 / 2, this.size, this.size / 1.5); ctx.fillStyle = "rgba(255, 255, 255, 0.5)"; ctx.fillRect(-this.size / 2, -this.size / 1.5 / 2, 3, this.size / 1.5); } else { ctx.fillRect(-this.size / 2, -this.size / 8 / 2, this.size, this.size / 8); ctx.beginPath(); ctx.moveTo(this.size / 2, -this.size / 8 / 2); ctx.lineTo(this.size / 2 + 5, 0); ctx.lineTo(this.size / 2, this.size / 8 / 2); ctx.fill(); } ctx.restore(); }
Â  Â  Â  Â  }
Â  Â  Â  Â  function initParticles() { particles = []; for (let i = 0; i < 40; i++) { particles.push(new Particle()); } }
Â  Â  Â  Â  function animateCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); for (let i = 0; i < particles.length; i++) { particles[i].update(); particles[i].draw(); } requestAnimationFrame(animateCanvas); }

Â  Â  Â  Â  // --- FUNGSI MODAL (BARU DENGAN FADE) ---
Â  Â  Â  Â  function openNavModal() {Â 
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());Â 
Â  Â  Â  Â  Â  Â  modalNavTitle.textContent = isReviewMode ? "Daftar Soal (Review)" : "Daftar Soal";Â 
Â  Â  Â  Â  Â  Â  modalBackdropNav.classList.remove('hidden');Â 
Â  Â  Â  Â  Â  Â  modalContainerNav.classList.remove('hidden');Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => { // Tunda fade in
Â  Â  Â  Â  Â  Â  Â  Â  Â modalBackdropNav.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  Â modalContainerNav.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  Â modalContainerNav.style.transform = 'translate(-50%, -50%) scale(1)';
Â  Â  Â  Â  Â  Â  }, 10);
Â  Â  Â  Â  }
Â  Â  Â  Â  function closeNavModal(playSound = true) {Â 
Â  Â  Â  Â  Â  Â  if (playSound) { popSfxLow.triggerAttackRelease('C5', '16n', Tone.now()); }Â 
Â  Â  Â  Â  Â  Â  modalBackdropNav.classList.add('opacity-0');Â 
Â  Â  Â  Â  Â  Â  modalContainerNav.classList.add('opacity-0');
Â  Â  Â  Â  Â  Â  modalContainerNav.style.transform = 'translate(-50%, -50%) scale(0.95)';
Â  Â  Â  Â  Â  Â  setTimeout(() => { // Tunda hidden
Â  Â  Â  Â  Â  Â  Â  Â  Â modalBackdropNav.classList.add('hidden');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â modalContainerNav.classList.add('hidden');Â 
Â  Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  }
Â  Â  Â  Â  function openFinishModal() {
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());
Â  Â  Â  Â  Â  Â  modalBackdropFinish.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  modalContainerFinish.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  modalBackdropFinish.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  modalContainerFinish.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  modalContainerFinish.style.transform = 'translate(-50%, -50%) scale(1)';
Â  Â  Â  Â  Â  Â  }, 10);
Â  Â  Â  Â  }
Â  Â  Â  Â  function closeFinishModal(playSound = true) {
Â  Â  Â  Â  Â  Â  if (playSound) { popSfxLow.triggerAttackRelease('C5', '16n', Tone.now()); }
Â  Â  Â  Â  Â  Â  modalBackdropFinish.classList.add('opacity-0');
Â  Â  Â  Â  Â  Â  modalContainerFinish.classList.add('opacity-0');
Â  Â  Â  Â  Â  Â  modalContainerFinish.style.transform = 'translate(-50%, -50%) scale(0.95)';
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  modalBackdropFinish.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  modalContainerFinish.classList.add('hidden');
Â  Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  }

Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- FUNGSI TIMER ---
Â  Â  Â  Â  function updateTimer() {
Â  Â  Â  Â  Â  Â  remainingTime--;
Â  Â  Â  Â  Â  Â  const minutes = Math.floor(remainingTime / 60);
Â  Â  Â  Â  Â  Â  const seconds = remainingTime % 60;
Â  Â  Â  Â  Â  Â  timerDisplay.textContent = `${minutes < 10 ? '0' : ''}${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
Â  Â  Â  Â  Â  Â  if (remainingTime <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(timerInterval);
Â  Â  Â  Â  Â  Â  Â  Â  alarmSfx.triggerAttackRelease('A5', '8n', Tone.now());
Â  Â  Â  Â  Â  Â  Â  Â  alarmSfx.triggerAttackRelease('A5', '8n', Tone.now() + 0.4);
Â  Â  Â  Â  Â  Â  Â  Â  alarmSfx.triggerAttackRelease('A5', '8n', Tone.now() + 0.8);
Â  Â  Â  Â  Â  Â  Â  Â  showScore(); // Auto-submit
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- FUNGSI NAVIGASI LAYAR (DENGAN FADE EFX) ---
Â  Â  Â  Â Â 
Â  Â  Â  Â  // BARU: Helper function untuk transisi
Â  Â  Â  Â  function transitionScreen(outgoing, incoming) {
Â  Â  Â  Â  Â  Â  outgoing.classList.add('slide-out-up'); // Mulai animasi keluar

Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  outgoing.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  outgoing.classList.remove('slide-out-up'); // Reset
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Siapkan layar baru (posisi awal)
Â  Â  Â  Â  Â  Â  Â  Â  incoming.classList.add('opacity-0');Â 
Â  Â  Â  Â  Â  Â  Â  Â  incoming.style.transform = 'translateY(20px) scale(0.98)';
Â  Â  Â  Â  Â  Â  Â  Â  incoming.classList.remove('hidden');Â 
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Tunda sedikit, lalu animasikan masuk
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  incoming.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  incoming.style.transform = 'translateY(0px) scale(1)';
Â  Â  Â  Â  Â  Â  Â  Â  }, 20); // Penundaan singkat untuk memicu transisi CSS

Â  Â  Â  Â  Â  Â  }, 350); // Sesuaikan dengan durasi transisi di CSS
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  async function startQuiz(subjectId) {
Â  Â  Â  Â  Â  Â  isReviewMode = false;Â 
Â  Â  Â  Â  Â  Â  await initAudio(); // Inisialisasi Tone.js/SFX
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  transitionScreen(menuContainer, quizContainer); // <-- BARU: Transisi
Â  Â  Â  Â  Â  Â  setMusicVolume(LOW_VOLUME); // Volume turun saat kuis

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  let flatQuestions = [];Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (quizzesCache.has(subjectId)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  flatQuestions = quizzesCache.get(subjectId);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // *** PERBAIKAN "CACHE BUSTER" ***
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ini akan memaksa browser/server mengambil file versi baru
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const timestamp = new Date().getTime(); // Dapatkan angka unik (waktu saat ini)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(`./data/${subjectId}.json?v=${timestamp}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // *** AKHIR PERBAIKAN ***
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) throw new Error(`File data/${subjectId}.json tidak ditemukan.`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const fetchedData = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (fetchedData.length > 0 && fetchedData[0].questions) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fetchedData.forEach(group => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  group.questions.forEach(q => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  flatQuestions.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ...q,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  passageTitle: group.passageTitle,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  passageText: group.passageTextÂ  Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  flatQuestions = fetchedData;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  quizzesCache.set(subjectId, flatQuestions);Â 
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  activeQuizData = flatQuestions;
Â  Â  Â  Â  Â  Â  Â  Â  const subject = allSubjects.find(s => s.id === subjectId);
Â  Â  Â  Â  Â  Â  Â  Â  quizTitle.textContent = subject.title;

Â  Â  Â  Â  Â  Â  Â  Â  currentQuestionIndex = 0;
Â  Â  Â  Â  Â  Â  Â  Â  score = 0;
Â  Â  Â  Â  Â  Â  Â  Â  userAnswers = new Array(activeQuizData.length).fill(null);Â 
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  generateQuestionPanel();Â 
Â  Â  Â  Â  Â  Â  Â  Â  remainingTime = 80 * 60;Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (timerInterval) clearInterval(timerInterval);
Â  Â  Â  Â  Â  Â  Â  Â  timerInterval = setInterval(updateTimer, 1000);
Â  Â  Â  Â  Â  Â  Â  Â  updateTimer();Â 

Â  Â  Â  Â  Â  Â  Â  Â  // Tampilkan spinner dulu
Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.add('opacity-0');Â 
Â  Â  Â  Â  Â  Â  Â  Â  questionLoadingSpinner.classList.remove('hidden');Â 

Â  Â  Â  Â  Â  Â  Â  Â  // PERBAIKAN BUG FADE-IN: Tunggu loadQuestion (termasuk MathJax) selesai
Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionLoadingSpinner.classList.add('hidden');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.remove('opacity-0'); // Fade in
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'translateY(0px) scale(1)'; // Pastikan state-nya benar
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Gagal memuat kuis:", error);
Â  Â  Â  Â  Â  Â  Â  Â  // *** PERBAIKAN ERROR MESSAGE: Lebih spesifik dan kasih tahu letak file ***
Â  Â  Â  Â  Â  Â  Â  Â  let errorMessage = `Gagal memuat data kuis. Cek file JSON: ${subjectId}.json`;
Â  Â  Â  Â  Â  Â  Â  Â  if (error.message.includes('404')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â errorMessage += `\n\nError 404 (File Not Found). Pastikan file "${subjectId}.json" ada di dalam folder "/data/" di GitHub Anda.`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  alert(errorMessage);
Â  Â  Â  Â  Â  Â  Â  Â  goToMenu();
Â  Â  Â  _ Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // BARU: Buat fungsi reset animasi tombol menu
Â  Â  Â  Â  function resetSubjectButtonAnimations() {
Â  Â  Â  Â  Â  Â  const items = subjectButtonContainer.querySelectorAll('.reveal-item');
Â  Â  Â  Â  Â  Â  items.forEach((item, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  item.style.opacity = 0; // Reset
Â  Â  Â  Â  Â  Â  Â  Â  item.classList.remove('reveal-item');
Â  Â  Â  Â  Â  Â  Â  Â  void item.offsetWidth; // Force reflow
Â  Â  Â  Â  Â  Â  Â  Â  item.classList.add('reveal-item');
Â  Â  Â  Â  Â  Â  Â  Â  item.style.animationDelay = `${index * 50}ms`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  startBtn.style.opacity = 0;
Â  Â  Â  Â  Â  Â  startBtn.classList.remove('reveal-item');
Â  Â  Â  Â  Â  Â  void startBtn.offsetWidth;
Â  Â  Â  Â  Â  Â  startBtn.classList.add('reveal-item');
Â  Â  Â  Â  Â  Â  startBtn.style.animationDelay = `${items.length * 50}ms`;
Â  Â  Â  Â  }

Â  Â  Â  Â  function goToMenu() {
Â  Â  Â  Â  Â  Â  isReviewMode = false;Â 
Â  Â  Â  Â  Â  Â  setMusicVolume(HIGH_VOLUME); // Volume naik ke normal
Â  Â  Â  Â  Â  Â  if (timerInterval) clearInterval(timerInterval);Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const activeContainer = !quizContainer.classList.contains('hidden') ? quizContainer : scoreContainer;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  transitionScreen(activeContainer, menuContainer); // <-- BARU: Transisi
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // BARU: Jalankan animasi staggered lagi saat kembali ke menu
Â  Â  Â  Â  Â  Â  setTimeout(resetSubjectButtonAnimations, 350);Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  async function restartQuiz() {
Â  Â  Â  Â  Â  Â  isReviewMode = false;Â 
Â  Â  Â  Â  Â  Â  await initAudio();Â 
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());

Â  Â  Â  Â  Â  Â  transitionScreen(scoreContainer, quizContainer); // <-- BARU: Transisi
Â  Â  Â  Â  Â  Â  setMusicVolume(LOW_VOLUME); // Volume turun saat kuis
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Tampilkan spinner dulu
Â  Â  Â  Â  Â  Â  questionArea.classList.add('opacity-0');Â 
Â  Â  Â  Â  Â  Â  questionLoadingSpinner.classList.remove('hidden');

Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  currentQuestionIndex = 0;
Â  Â  Â  Â  Â  Â  Â  Â  score = 0;
Â  Â  Â  Â  Â  Â  Â  Â  userAnswers = new Array(activeQuizData.length).fill(null);Â 
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  generateQuestionPanel();Â 
Â  Â  Â  Â  Â  Â  Â  Â  remainingTime = 80 * 60;Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (timerInterval) clearInterval(timerInterval);
Lainnya Â  Â  Â  Â  Â  Â  Â  Â  timerInterval = setInterval(updateTimer, 1000);
Â  Â  Â  Â  Â  Â  Â  Â  updateTimer();Â 

Â  Â  Â  Â  Â  Â  Â  Â  // PERBAIKAN BUG FADE-IN
Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionLoadingSpinner.classList.add('hidden');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.remove('opacity-0'); // Fade in
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'translateY(0px) scale(1)'; // Pastikan state-nya benar
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 350); // Tunda setup kuis sampai transisi selesai
Â  Â  Â  Â  }

Â  Â  Â  Â  // BARU: Fungsi untuk menghitung skor
Â  Â  Â  Â  function calculateScore() {
Â  Â  Â  Â  Â  Â  score = 0; // Reset skor
Â  Â  Â  Â  Â  Â  for (let i = 0; i < activeQuizData.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  if (userAnswers[i] === activeQuizData[i].correctAnswer) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  score++;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function showScore() {
Â  Â  Â  Â  Â  Â  // PERUBAHAN: Skor dihitung HANYA saat kuis selesai
Â  Â  Â  Â  Â  Â  if (!isReviewMode) {
Â  Â  Â  Â  Â  Â  Â  Â  calculateScore();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  transitionScreen(quizContainer, scoreContainer); // <-- BARU: Transisi
Â  Â  Â  Â  Â  Â  closeFinishModal(false); // Tutup modal konfirmasi jika terbuka
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  scoreText.textContent = `${score} / ${activeQuizData.length}`;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // PERUBAHAN: Selalu set isReviewMode ke false saat kembali ke skor
Â  Â  Â  Â  Â  Â  Â  Â  isReviewMode = false;Â 
Â  Â  Â  Â  Â  Â  Â  Â  setMusicVolume(HIGH_VOLUME); // Volume naik ke normal
Â  Â  Â  Â  Â  Â  Â  Â  if (timerInterval) clearInterval(timerInterval);Â 
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  closeNavModal(false);s 
Â  Â  Â  Â  Â  Â  }, 350);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function startReview() {
Â  Â  Â  Â  Â  Â  isReviewMode = true;
Â  Â  Â  Â  Â  Â  currentQuestionIndex = 0;

Â  Â  Â  Â  Â  Â  transitionScreen(scoreContainer, quizContainer); // <-- BARU: Transisi
Â  Â  Â  Â  Â  Â  setMusicVolume(LOW_VOLUME); // Volume turun saat kuis

Â  Â  Â  Â  Â  Â  // Tampilkan spinner dulu
Â  Â  Â  Â  Â  Â  questionArea.classList.add('opacity-0');Â 
Â  Â  Â  Â  Â  Â  questionLoadingSpinner.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  // PERBAIKAN BUG FADE-IN
Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionLoadingSpinner.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.remove('opacity-0'); // Fade in
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'translateY(0px) scale(1)'; // Pastikan state-nya benar
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 350); // Tunda load soal sampai transisi selesai
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- FUNGSI LOGIKA KUIS LAIN ---
Â  Â  Â  Â  /* PERUBAHAN: Sekarang mengisi kedua panel (modal & desktop) */
Â  Â  Â  Â  function generateQuestionPanel() {
Â  Â  Â  Â  Â  Â  quizNavPanel.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â  desktopNavPanel.innerHTML = ''; // Kosongkan panel desktop
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  for (let i = 0; i < activeQuizData.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const button = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  button.textContent = i + 1;
Â  Â  Â  Â  Â  Â  Â  Â  button.className = 'q-nav-btn q-nav-unanswered';Â 
Â  Â  Â  Â  Â  Â  Â  Â  button.dataset.index = i; // Gunakan data-index
Â  Â  Â  Â  Â  Â  Â  Â  button.addEventListener('click', () => jumpToQuestion(i, true)); // true = from modal
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const desktopButton = button.cloneNode(true); // Duplikat tombol
Â  Â  Â  Â  Â  Â  Â  Â  desktopButton.addEventListener('click', () => jumpToQuestion(i, false)); // false = from desktop
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  quizNavPanel.appendChild(button);
Â  Â  Â  Â  Â  Â  Â  Â  desktopNavPanel.appendChild(desktopButton);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERUBAHAN: Logika panel navigasi diubah & pakai querySelectorAll */
Â  Â  Â  Â  function updateQuestionPanelState() {
Â  Â  Â  Â  Â  Â  // PERUBAHAN: Gunakan querySelectorAll.q-nav-btn
Â  Â  Â  Â  Â  Â  const allNavButtons = document.querySelectorAll('.q-nav-btn');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  allNavButtons.forEach(button => {
Â  Â  Â  Â  Â  Â  Â  Â  const index = parseInt(button.dataset.index); // Ambil index dari data-*
Â  Â  Â  Â  Â  Â  Â  Â  if (isNaN(index)) return;

Â  Â  Â  Â  Â  Â  Â  Â  button.className = 'q-nav-btn'; // Reset class
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (index === currentQuestionIndex) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('q-nav-active'); // Selalu kuning untuk soal aktif
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  } else if (userAnswers[index] !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (isReviewMode) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Mode Review: Tampilkan Hijau/Merah
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isCorrect = (userAnswers[index] === activeQuizData[index].correctAnswer);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add(isCorrect ? 'q-nav-answered' : 'q-nav-wrong-answered');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Mode Kuis Normal: Tampilkan Biru Netral
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('q-nav-answered-quiz');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('q-nav-unanswered');Â 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERUBAHAN: Tambah parameter 'fromModal' */
Â  Â  Â  Â  function jumpToQuestion(index, fromModal = false) {
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());
Â  Â  Â  Â  Â  Â  questionArea.classList.add('opacity-0'); // Fade out soal
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  currentQuestionIndex = index;
Â  Â  Â  Â  Â  Â  Â  Â  // PERBAIKAN BUG: Tunggu loadQuestion (termasuk MathJax) selesai, baru fade in
Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion().then(() => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => questionArea.classList.remove('opacity-0'), 10); // Fade in
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 300); // Durasi fade-out soal (tetap cepat)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (fromModal) {
Â  Â  Â  Â  Â  Â  Â  Â  closeNavModal(false); // Tutup modal HANYA jika klik dari modal
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- FUNGSI LOADQUESTION (DENGAN MATHJAX DAN FADE IN) ---
Â  Â  Â  Â  /* PERUBAHAN: Logika Tampilan dipecah */
Â  Â  Â  Â  function loadQuestion() {
Â  Â  Â  Â  Â  Â  explanationBox.classList.add('hidden');Â 
Â  Â  Â  Â  Â  Â  optionsContainer.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â  const questionData = activeQuizData[currentQuestionIndex];

Â  Â  Â  Â  Â  Â  if (questionData.passageText) {
Â  Â  Â  Â  Â  Â  Â  Â  passageTitleEl.innerHTML = questionData.passageTitle; // Pakai innerHTML
Â  Â  Â  Â  Â  Â  Â  Â  passageContentEl.innerHTML = questionData.passageText; // Pakai innerHTML
Â  Â  Â  Â  Â  Â  Â  Â  passageContainer.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  passageContainer.classList.add('hidden');
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  questionText.innerHTML = questionData.question; // Pakai innerHTML
Â  Â  Â  Â  Â  Â  questionCounter.textContent = `Soal ${currentQuestionIndex + 1} dari ${activeQuizData.length}`;
Â  Â  Â  Â  Â  Â  questionData.options.forEach((option, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  const button = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  const optionLetter = String.fromCharCode(65 + index);
Â  Â  Â  Â  Â  Â  Â  Â  button.innerHTML = `${optionLetter}. ${option}`; // Pakai innerHTML
Â  Â  Â  Â  Â  Â  Â  Â  button.className = 'option-btn border p-3 text-left w-full focus:outline-none focus:ring-2 focus:ring-blue-500';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // BARU: Tambahkan staggered animation
Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('reveal-item');
Â  Â  Â  Â  Â  Â  Â  Â  button.style.animationDelay = `${index * 50}ms`; // Delay 50ms per opsi
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (!isReviewMode) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.addEventListener('click', () => handleAnswer(index));
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  optionsContainer.appendChild(button);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateNavButtons();
Â  Â  Â  Â  Â  Â  updateQuestionPanelState();Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (isReviewMode) {
Â  Â  Â  Â  Â  Â  Â  Â  // --- MODE REVIEW ---
Â  Â  Â  Â  Â  Â  Â  Â  // Tampilkan jawaban benar/salah dan penjelasan
Â  Â  Â  Â  Â  Â  Â  Â  timerDisplay.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  showFeedback(userAnswers[currentQuestionIndex] !== null ? userAnswers[currentQuestionIndex] : -1);Â 
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // --- MODE KUIS NORMAL ---
Â  Â  Â  Â  Â  Â  Â  Â  // Hanya tampilkan jawaban yang dipilih (jika ada), TANPA penjelasan
Â  Â  Â  Â  Â  Â  Â  Â  timerDisplay.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  explanationBox.classList.add('hidden'); // Pastikan penjelasan tersembunyi
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const selectedAnswer = userAnswers[currentQuestionIndex];
Â  Â  Â  Â  Â  Â  Â  Â  if (selectedAnswer !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const buttons = optionsContainer.getElementsByTagName('button');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (buttons[selectedAnswer]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttons[selectedAnswer].classList.add('selected-answer');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // PERUBAHAN: Tombol tidak lagi di-disable saat kuis
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // buttons.forEach(btn => btn.disabled = true);Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  // *** PERBAIKAN SOLUSI DARI KAMU (MathJax v3) ***
Â  Â  Â  Â  Â  Â  // Ini adalah cara yang benar untuk merender ulang konten dinamis
Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  if (window.MathJax) {
Â  Â  Â  Â  Â  Â  Â  Â  // Kita panggil typesetPromise untuk area yang baru di-update
Â  Â  Â  Â  Â  Â  Â  Â  return MathJax.typesetPromise([passageContainer, questionArea, optionsContainer])
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .catch((err) => console.log('MathJax error:', err))
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .finally(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // (Tidak perlu fade in di sini, sudah di-handle di 'caller')
section Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Fallback jika MathJax gagal
Â  Â  Â  Â  Â  Â  Â  Â  return Promise.resolve(); // Kembalikan promise kosong
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERUBAHAN: handleAnswer (Mode Kuis) */
Â  Â  Â  Â  function handleAnswer(selectedOptionIndex) {
Â  Â  Â  Â  Â  Â  // (Mode review tidak memanggil ini)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  popSfxMid.triggerAttackRelease('G5', '16n', Tone.now()); // Suara sedang (G5)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  userAnswers[currentQuestionIndex] = selectedOptionIndex; // Simpan jawaban
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Perbarui tampilan tombol (HANYA tanda biru)
Â  Â  Â  Â  Â  Â  const buttons = optionsContainer.getElementsByTagName('button');
Â  Â  Â  Â  Â  Â  for (let i = 0; i < buttons.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  buttons[i].classList.remove('selected-answer'); // Hapus pilihan lama
Â  Â  Â  Â  Â  Â  Â  Â  // PERUBAHAN: Tombol tidak lagi di-disable
Â  Â  Â  Â  Â  Â  Â  Â  // buttons[i].disabled = true;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  buttons[selectedOptionIndex].classList.add('selected-answer'); // Tandai pilihan baru
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateQuestionPanelState(); // Perbarui panel navigasi (jadi biru)
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- FUNGSI SHOWFEEDBACK (DENGAN MATHJAX) ---
Â  Â  Â  Â  /* PERUBAHAN: Fungsi ini HANYA dipanggil dalam Mode Review */
Â  Â  Â  Â  function showFeedback(selectedOptionIndex) {
Â  Â  Â  Â  Â  Â  const correctAnswerIndex = activeQuizData[currentQuestionIndex].correctAnswer;
Â  Â  Â  Â  Â  Â  const questionData = activeQuizData[currentQuestionIndex];
Â  Â  Â  Â  Â  Â  const buttons = optionsContainer.getElementsByTagName('button');

Â  Â  Â  Â  Â  Â  for (let i = 0; i < buttons.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  buttons[i].disabled = true; // Di mode review, tombol dikunci
Â  Â  Â  Â  Â  Â  Â  Â  if (i === correctAnswerIndex) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttons[i].classList.add('correct-answer'); // Tampilkan Hijau
section Â  Â  Â  Â  Â  Â  Â  } else if (i === selectedOptionIndex) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttons[i].classList.add('wrong-answer'); // Tampilkan Merah
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const isCorrect = (selectedOptionIndex === correctAnswerIndex);
Â  Â  Â  Â  Â  Â  if (isCorrect) {
Â  Â  Â  Â  Â  Â  Â  Â  explanationText.innerHTML = `<strong>Penjelasan:</strong> ${questionData.explanation}`; // Pakai innerHTML
Â  Â  Â  Â  Â  Â  Â  Â  explanationBox.className = 'mt-4 p-4 rounded-lg border explanation-correct';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  const correctLetter = String.fromCharCode(65 + correctAnswerIndex);
Â  Â  Â  Â  Â  Â  Â  Â  if (selectedOptionIndex === -1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â explanationText.innerHTML = `<strong>Anda tidak menjawab.</strong> Jawaban benar: ${correctLetter}.<br><br><strong>Penjelasan:</strong> ${questionData.explanation}`; // Pakai innerHTML
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  explanationText.innerHTML = `<strong>Jawaban benar: ${correctLetter}.</strong><br><br><strong>Penjelasan:</strong> ${questionData.explanation}`; // Pakai innerHTML
section Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  explanationBox.className = 'mt-4 p-4 rounded-lg border explanation-wrong';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  explanationBox.classList.remove('hidden'); // Tampilkan penjelasan
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateQuestionPanelState();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  // *** PERBAIKAN SOLUSI DARI KAMU (MathJax v3) ***
Â  Â  Â  Â  Â  Â  // Merender ulang kotak penjelasan
Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  if (window.MathJax) {
Â  Â  Â  Â  Â  Â  Â  Â  MathJax.typesetPromise([explanationBox]).catch((err) => console.log('MathJax error:', err));
section Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PERBAIKAN LOGIKA TOMBOL NAVIGASI */
Â  Â  Â  Â  function updateNavButtons() {
Â  Â  Â  Â  Â  Â  prevBtn.disabled = (currentQuestionIndex === 0);

Â  Â  Â  Â  Â  Â  if (isReviewMode) {
Â  Â  Â  Â  Â  Â  Â  Â  // --- MODE REVIEW (PERUBAHAN LOGIKA) ---
Â  Â  Â  Â  Â  Â  Â  Â  finishBtn.classList.add('hidden'); // 1. Sembunyikan tombol "Selesai" (Hijau)
Â  Â  Â  Â  Â  Â  Â  Â  reviewBackBtn.classList.remove('hidden'); // 2. Tampilkan "Kembali ke Menu Skor" (Merah)
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â  // *** PERMINTAAN KAMU: Hilangkan tombol "Kembali ke Menu" di atas ***
Â  Â  Â  Â  Â  Â  Â  Â  backToMenuQuizBtn.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (currentQuestionIndex === activeQuizData.length - 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Soal terakhir di mode review
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.classList.add('hidden'); // Sembunyikan "Berikutnya"
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  _ Â  Â  Â  Â  // Belum soal terakhir
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.classList.remove('hidden'); // Tampilkan "Berikutnya"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.textContent = 'Berikutnya';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // --- MODE KUIS NORMAL ---
Â  Â  Â  Â  Â  Â  Â  Â  finishBtn.classList.remove('hidden'); // Tampilkan "Selesai"
Â  Â  Â  Â  Â  Â  Â  Â  reviewBackBtn.classList.add('hidden'); // Sembunyikan "Kembali ke Menu Skor"
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â  // *** PERMINTAAN KAMU: Tampilkan lagi tombol "Kembali ke Menu" di atas ***
Â  Â  Â  Â  Â  Â  Â  Â  backToMenuQuizBtn.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.classList.remove('hidden'); // Tampilkan "Berikutnya"
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.disabled = (currentQuestionIndex === activeQuizData.length - 1);
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.textContent = 'Berikutnya';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â Â 
Â  Â  Â  Â  function buildSubjectButtons(subjects) {
Â  Â  Â  Â  Â  Â  subjectButtonContainer.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â  let isFirst = true;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  subjects.forEach((subject, index) => { // BARU: ambil index
Â  Â  Â  Â  Â  Â  Â  Â  const button = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  button.id = `subject-${subject.id}`;
Â  Â  Â  Â  Â  Â  Â  Â  button.textContent = subject.title;
Â  Â  Â  Â  Â  Â  Â  Â  // BARU: Tambah class reveal-item
Â  Â  Â  Â  Â  Â  Â  Â  button.className = `subject-btn interactive-btn reveal-item w-full p-4 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all ${isFirst ? 'subject-active' : 'subject-inactive'}`;
Â  Â  Â  Â  Â  Â  Â  Â  // BARU: Tambah animation delay
Â  Â  Â  Â  Â  Â  Â  Â  button.style.animationDelay = `${index * 50}ms`;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  button.addEventListener('click', async () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Trigger first interaction handler
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await firstInteractionHandler();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  selectedSubjectId = subject.id;Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.subject-btn').forEach(btn => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove('subject-active');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.add('subject-inactive');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('subject-active');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.classList.remove('subject-inactive');
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  subjectButtonContainer.appendChild(button);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (isFirst) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  selectedSubjectId = subject.id;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isFirst = false;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  // *** PERBAIKAN: Tombol "Segera Hadir" Dihapus ***
Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  async function loadSubjects() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  // *** PERBAIKAN PATH KRITIS (1/2): subjects.json sekarang diambil dari folder /data/ ***
Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â  // *** PERBAIKAN "CACHE BUSTER" (Diterapkan di sini juga) ***
Â  Â  Â  Â  Â  Â  Â  Â  const timestamp = new Date().getTime();
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(`./data/subjects.json?v=${timestamp}`);Â 
Â  Â  Â  Â  Â  Â  Â  Â  // ==========================================================
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) throw new Error('subjects.json tidak ditemukan.');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  allSubjects = await response.json();

Â  Â  Â  Â  Â  Â  Â  Â  if (allSubjects.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("Tidak ada pelajaran di subjects.json");
section Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  buildSubjectButtons(allSubjects);Â 
Â  Â  Â  Â  Â  Â  Â  Â  // BARU: Tunda pemunculan tombol agar animasi jalan
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadingSpinner.classList.add('hidden');Indra 
Â  Â  Â  Â  Â  _ Â  Â  Â  Â  subjectButtonContainer.classList.remove('hidden');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startBtn.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // BARU: Animasikan tombol start juga
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startBtn.classList.add('reveal-item');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startBtn.style.animationDelay = `${allSubjects.length * 50}ms`;
Â  Â  Â  Â  Â  Â  Â  Â  }, 100);

Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error memuat daftar pelajaran:", error);
Â  Â  Â  Â  Â  Â  Â  Â  // *** PERBAIKAN PESAN ERROR: Memberi tahu user tentang folder /data/ ***
Â  Â  Â  Â  Â  Â  Â  Â  loadingSpinner.innerHTML = `
Â  Â  V Â  Â  Â  Â  Â  Â  Â  <strong class="text-red-600">Error: Gagal Memuat Daftar Pelajaran</strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-sm text-slate-600">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Pastikan file <strong>subjects.json</strong> ada di dalam folder <strong>/data/</strong>.
s Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }


Â  Â  Â  Â  // --- LOGIKA TEMA ---
Â  Â  Â  Â  function applyTheme(theme) { // Parameter isAuto dihapus
Â  Â  Â  Â  Â  Â  if (theme === 'dark') {
Â  Â  Â  Â  Â  Â  Â  Â  document.body.classList.add('dark');
Â  Â  Â  Â  Â  Â  Â  Â  // localStorage.setItem('theme', 'dark'); // Dihapus, di-handle oleh listener
Â  Â  Â  Â  Â  Â  Â  Â  // PERUBAHAN: Logika 'hidden' dipindah ke CSS
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  document.body.classList.remove('dark');
Â  Â  Â  Â  Â  Â  Â  Â  // localStorage.setItem('theme', 'light'); // Dihapus, di-handle oleh listener
Â  Â  Â  Â  Â  Â  Â  Â  // PERUBAHAN: Logika 'hidden' dipindah ke CSS
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  themeToggleButtonFloating.classList.toggle('active', theme === 'light');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Logika tombol Auto dihapus
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  initParticles(); // Re-initialize particles to update color for dark mode
Â  Â  Â  Â  }

Â  Â  Â  Â  /* PERUBAHAN: Fungsi loadTheme sekarang mendeteksi pengaturan device */
Â  Â  Â  Â  function loadTheme() {
Â  Â  Â  Â  Â  Â  const savedTheme = localStorage.getItem('theme');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (savedTheme) {
Â  Â  Â  Â  Â  Â  Â  Â  // 1. Prioritas utama: Pilihan manual pengguna (dari klik tombol)
Â  Â  Â  Â  Â  Â  Â  Â  applyTheme(savedTheme); // isAuto dihapus
Â  Â  Â  Â  Â  Â  } else if (window.matchMedia) {
Â  Â  Â  Â  Â  Â  Â  Â  // 2. Prioritas kedua: Deteksi pengaturan device
s Â  Â  Â  Â  Â  Â  Â  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Terapkan tema yang terdeteksi saat ini
Note Â  Â  Â  Â  Â  Â  Â  Â  applyTheme(mediaQuery.matches ? 'dark' : 'light'); // isAuto dihapus
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Tambahkan listener untuk mendeteksi perubahan di device
Â  Â  Â  Â  Â  Â  Â  Â  mediaQuery.addEventListener('change', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Cek lagi, JIKA pengguna MASIH BELUM memilih manual,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // maka ikuti perubahan device.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!localStorage.getItem('theme')) {
s Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  applyTheme(e.matches ? 'dark' : 'light'); // isAuto dihapus
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // 3. Fallback: Default ke mode terang jika media query tidak didukung
s Â  Â  Â  Â  Â  Â  Â  applyTheme('light'); // isAuto dihapus
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  /**
Â  Â  Â  Â  Â * Handler one-time untuk memastikan Tone.js aktif pada interaksi pertama.
s Â  Â  Â  Â  Â */
Â  Â  Â  Â  async function firstInteractionHandler() {
Â  Â  Â  Â  Â  Â  // Hapus listener global setelah dipanggil
Â  Â  Â  Â  Â  Â  document.body.removeEventListener('click', firstInteractionHandler);
Â  Â  Â  Â  Â  Â  document.body.removeEventListener('touchstart', firstInteractionHandler);

Â  Â  Â  Â  Â  Â  // Kita hanya perlu inisialisasi Tone.js/SFX di sini.
Â  Â  Â  Â  Â  Â  if (!audioInitialized) {
Â  Â  Â  Â  Â  Â  Â  Â  await initAudio();Â 
Â  Â  Â  Â  Â  Â  Â  Â  bgMusic.play().catch(e => console.warn("Play on tap failed:", e));A 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }


Â  Â  Â  Â  // --- TITIK MULAI APLIKASI ---
Â  Â  Â  Â  window.addEventListener('load', () => {
Â  Â  Â  Â  Â  Â  // BARU: Atur state awal untuk transisi
Â  Â  Â  Â  Â  Â  quizContainer.classList.add('hidden', 'opacity-0');
Â  Â  Â  Â  Â  Â  quizContainer.style.transform = 'translateY(20px) scale(0.98)';
Â  Â  Â  Â  Â  Â  scoreContainer.classList.add('hidden', 'opacity-0');
Â  Â  Â  Â  Â  Â  scoreContainer.style.transform = 'translateY(20px) scale(0.98)';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  loadTheme(); // Muat tema tersimpan
Â  Â  Â  Â  Â  Â  resizeCanvas();
Â  Â  Â  Â  Â  Â  initParticles();
Â  Â  Â  Â  Â  Â  animateCanvas();
Â  Â  Â  Â  Â  Â  window.addEventListener('resize', () => { resizeCanvas(); initParticles(); });
Â  Â  Â  Â  Â  Â  loadSubjects();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Coba mainkan musik (muted) saat load
Â  Â  Â  Â  Â  Â  bgMusic.play().catch(e => console.warn("Autoplay (muted) gagal.", e));
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Set ikon status musik awal (muted)
Â  Â  Â  Â  Â  Â  updateMusicState(isUserMuted);

Â  section Â  Â  Â  Â  // Tambahkan event listener untuk interaksi pertama di body
Â  Â  Â  Â  Â  Â  // Interaksi pertama akan membuat Tone.js siap dan musik play (muted)
Â  Â  Â  Â  Â  Â  document.body.addEventListener('click', firstInteractionHandler);
Â  Â  Â  Â  Â  Â  document.body.removeEventListener('touchstart', firstInteractionHandler);
Â  Â  Â  Â  });

Â  Â  Â  Â  // Event Listener Tombol Menu
Â  Â  Â  Â  startBtn.addEventListener('click', async () => {
section Â  Â  Â  Â  Â  Â  // Cukup panggil initAudio agar SFX siap, tidak perlu logika unmute di sini.
Â  Â  Â  Â  Â  Â  await initAudio();Â 
Â  Â  Â  Â  Â  Â  if (selectedSubjectId) {
Â  Â  Â  Â  Â  Â  Â  Â  startQuiz(selectedSubjectId);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Silakan pilih mata pelajaran terlebih dahulu.");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
section 
Â  Â  Â  Â  // Event Listener Kuis
Â  Â  Â  Â  nextBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now()); // PERBAIKAN: SFX ditambahkan (Tinggi)
Â  Â  Â  Â  Â  Â  questionArea.classList.add('opacity-0'); // 1. Fade out soal
Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'scale(0.97)';
Â  Â  Â  Â  Â  Â  setTimeout(() => {
s Â  Â  Â  Â  Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  Â  Â  Â  Â  Â  // 2. Muat soal, TUNGGU MathJax, 3. Fade in
Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion().then(() => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Lainnya Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'scale(1)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, 10);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 300); // 4. Tunggu fade out selesai
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  prevBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  popSfxLow.triggerAttackRelease('C5', '16n', Tone.now()); // PERBAIKAN: SFX ditambahkan (Rendah)
Â  Â  Â  Â  Â  Â  questionArea.classList.add('opacity-0'); // 1. Fade out soal
Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'scale(0.97)';
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  if (currentQuestionIndex > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentQuestionIndex--;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 2. Muat soal, TUNGGU MathJax, 3. Fade in
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.remove('opacity-0');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'scale(1)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Dima Â  }, 10);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.classList.remove('opacity-0'); // Batal fade out jika di soal pertama
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  questionArea.style.transform = 'scale(1)';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }, 300); // 4. Tunggu fade out selesai
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  finishBtn.addEventListener('click', openFinishModal); // Tombol Selesai BARU
Â  Â  Â  Â  reviewBackBtn.addEventListener('click', showScore); // BARU: Tombol Kembali Review (langsung ke skor)
Â  Â  Â  Â Â 
Â  Â  Â  Â  backToMenuQuizBtn.addEventListener('click', goToMenu);

Â  Â  Â  Â  // Event Listener Skor
Â  Â  Â  Â  reviewBtn.addEventListener('click', startReview);Â 
Â  Â  Â  Â  resetBtn.addEventListener('click', restartQuiz);
Â  Â  Â  Â  backToMenuScoreBtn.addEventListener('click', goToMenu);Â 

Â  Â  Â  Â  // --- EVENT LISTENER PENGATURAN FLOATING ---

Â  Â  Â  Â  // Toggle Musik Floating
Â  Â  Â  Â  musicToggleButtonFloating.addEventListener('click', async () => {
Â  Â  Â  Â  Â  Â  Â // Pastikan Tone.js sudah diinisialisasi (misal, saat klik tombol Volume ini)
Â  Â  Â  Â  Â  Â  await initAudio();Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Toggle state-nya
note Â  Â  Â  Â  Â  const newMuteState = !isUserMuted;
Â  Â  Â  Â  Â  Â  updateMusicState(newMuteState);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Atur volume berdasarkan di mana dia berada (Hanya jika di-unmute)
s Â  Â  Â  Â  Â  if (!newMuteState && quizContainer.classList.contains('hidden')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â setMusicVolume(HIGH_VOLUME); // Menu/Skor
Â  Â  Â  Â  Â  Â  } else if (!newMuteState && !quizContainer.classList.contains('hidden')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â setMusicVolume(LOW_VOLUME); // Kuis
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // Toggle Tema Floating (MANUAL)
Â  Â  Â  Â  themeToggleButtonFloating.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
Â  Â  Â  Â  Â  Â  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
Â  Â  Â  Â  Â  Â  // Saat user klik, ini dihitung sebagai pilihan manual
Â  Â  Â  Â  Â  Â  localStorage.setItem('theme', newTheme);
Â  Â  Â  Â  Â  Â  applyTheme(newTheme); // isAuto dihapus
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  // BARU: Tombol Auto-Tema (DIHAPUS)
Â  Â  Â  Â  /*
Â  Â  Â  Â  themeAutoBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â localStorage.removeItem('theme'); // Hapus override manual
Â  Â  Â  Â  Â  Â  Â loadTheme(); // Muat ulang tema (akan mendeteksi device)
section Â  Â  Â  Â  });
Â  Â  Â  Â  */


Â  Â  Â  Â  // Event Listener Modal Navigasi (tetap)
Â  Â  Â  Â  openNavBtn.addEventListener('click', openNavModal);
Â  Â  Â  Â  closeNavBtn.addEventListener('click', () => closeNavModal(true));
Â  Â  Â  Â  modalBackdropNav.addEventListener('click', () => closeNavModal(true));
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Event Listener Modal Selesai (BARU)
Â  Â  Â  Â  cancelFinishBtn.addEventListener('click', () => closeFinishModal(true));
section Â  Â  Â  Â  modalBackdropFinish.addEventListener('click', () => closeFinishModal(true));
Â  Â  Â  Â  confirmFinishBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  popSfxHigh.triggerAttackRelease('C6', '16n', Tone.now());
Indra Â  Â  Â  Â  Â  // Tutup modal dulu (tanpa suara), baru tampilkan skor
Â  Â  Â  Â  Â  Â  closeFinishModal(false);Â 
Â  Â  Â  Â  Â  Â  showScore();
Â  Â  Â  Â  });

Â  Â  </script>
</body>
</html>
